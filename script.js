(()=>{"use strict";var t;!function(t){t.DEFAULT="default",t.SUCCESS="success",t.WARNING="warning",t.ERROR="error"}(t||(t={}));class e{constructor(s,r,o=t.DEFAULT,a=0,n=!0){this.heading=s,this.message=r,this.style=o,this.notification=this.createNotification(),this.button_container=this.createButtonContainer(),n&&this.createCloseButton(),e.container.appendChild(this.notification),a>0&&(this.timeout=window.setTimeout(this.closeNotification.bind(this),a))}createNotification(){const t=document.createElement("div");t.classList.add(this.style);const e=document.createElement("h1");e.textContent=this.heading,t.appendChild(e);const s=document.createElement("p");return s.innerHTML=this.message,t.appendChild(s),t}createButtonContainer(){const t=document.createElement("div");return t.classList.add("flex_row"),this.notification.appendChild(t),t}createCloseButton(){const t=document.createElement("div");t.textContent="Close",t.classList.add("button"),t.addEventListener("click",this.closeNotification.bind(this)),this.button_container.appendChild(t)}closeNotification(){this.notification.remove(),this.timeout&&window.clearTimeout(this.timeout)}}e.container=document.getElementById("notifs_container");class s extends e{constructor(t,e,s,r,o){super(e,s,r,void 0,!1),this.resolve=t,this.setupPromptButtons(o)}setupPromptButtons(t){t.forEach((t=>{const e=document.createElement("div");e.textContent=t.label,e.classList.add("button"),e.addEventListener("click",(()=>{t.closes&&this.closeNotification(),t.resolves&&this.resolve(t.retval),t.func&&t.func()})),this.button_container.appendChild(e)}))}static prompt(e,r,o=t.DEFAULT,a){return new Promise((t=>{new s(t,e,r,o,a)}))}}class r{constructor(){var e;this.settings={researches:[],recipes:[],inputs:[],outputs:[]},this.loaded_via_params=!1;const o=null!==(e=this.getFromSearchParams())&&void 0!==e?e:this.getFromLocalStorage();if(!o)return;let a=null;try{a=this.parseAndValidate(o)}catch(e){let a="Error",n="Unknown error",i="Unknown error";e instanceof SyntaxError?(a="Error: JSON Syntax",n=`\n\t\t\t\t\tThe JSON strings are malformed and could not be parsed.<br>\n\t\t\t\t\tWould you like to clear your ${this.loaded_via_params?"search parameters":"local storage"}?<br><br>\n\t\t\t\t\tThis action is irreversible and will result in your selected researches, recipes and current calculation being deleted.\n\t\t\t\t`,i=`${e.message}: ${o.researches} | ${o.recipes} | ${o.inputs} | ${o.outputs}`):e instanceof Error&&(n=e.message,i=e.message),s.prompt(a,n,t.ERROR,[{label:"Clear",closes:!0,resolves:!0,retval:!0,func:this.loaded_via_params?r.clearSearchParameters:r.clearLocalStorage},{label:"Abort",closes:!0,resolves:!0,retval:!1},{label:"Copy all details",closes:!1,resolves:!1,func:()=>{navigator.clipboard.writeText(i)}}])}a&&(this.settings=a)}static clearSearchParameters(){const t=new URL(window.location.href);t.search="",history.pushState(null,"",t.toString()),window.location.reload()}static clearLocalStorage(){window.localStorage.clear(),window.location.reload()}parseAndValidate(t){var e,s,r,o;const a={researches:JSON.parse(null!==(e=t.researches)&&void 0!==e?e:"[]"),recipes:JSON.parse(null!==(s=t.recipes)&&void 0!==s?s:"[]"),inputs:JSON.parse(null!==(r=t.inputs)&&void 0!==r?r:"[]"),outputs:JSON.parse(null!==(o=t.outputs)&&void 0!==o?o:"[]")};for(const t of Object.values(a)){if(!Array.isArray(t))throw new Error("One of the parameters isn't an array.");for(const e of t)if("number"!=typeof e)throw new Error("One of the values isn't a number.")}return a}getFromSearchParams(){if(!window.location.search)return null;const t=new URLSearchParams(window.location.search),e={researches:t.get("researches"),recipes:t.get("recipes"),inputs:t.get("inputs"),outputs:t.get("outputs")};return this.loaded_via_params=!0,e}getFromLocalStorage(){return window.localStorage?0===window.localStorage.length?null:{researches:window.localStorage.getItem("researches"),recipes:window.localStorage.getItem("recipes"),inputs:window.localStorage.getItem("inputs"),outputs:window.localStorage.getItem("outputs")}:null}}class o{constructor(){this.settings=new r}static initialize(){new o}}o.initialize()})();