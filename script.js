(()=>{"use strict";var t;!function(t){t.DEFAULT="default",t.SUCCESS="success",t.WARNING="warning",t.ERROR="error"}(t||(t={}));class e{constructor(n,i,o=t.DEFAULT,a=0,r=!0){this.heading=n,this.message=i,this.style=o,this.notification=this.createNotification(),this.button_container=this.createButtonContainer(),r&&this.createCloseButton(),e.container.appendChild(this.notification),a>0&&(this.timeout=window.setTimeout(this.closeNotification.bind(this),a))}createNotification(){const t=document.createElement("div");t.classList.add(this.style);const e=document.createElement("h1");e.textContent=this.heading,t.appendChild(e);const n=document.createElement("p");return n.innerHTML=this.message,t.appendChild(n),t}createButtonContainer(){const t=document.createElement("div");return t.classList.add("flex_row"),this.notification.appendChild(t),t}createCloseButton(){const t=document.createElement("div");t.textContent="Close",t.classList.add("button"),t.addEventListener("click",this.closeNotification.bind(this)),this.button_container.appendChild(t)}closeNotification(){this.notification.remove(),this.timeout&&window.clearTimeout(this.timeout)}}e.container=document.getElementById("notifs_container");class n extends e{constructor(e,n,i=t.DEFAULT,o){super(e,n,i,0,!1),this.buttons=o}setupPromptButtons(t){this.buttons.forEach((e=>{const n=document.createElement("div");n.textContent=e.label,n.classList.add("button"),n.addEventListener("click",this.closeNotification.bind(this)),n.addEventListener("click",(()=>t(e.retval))),this.button_container.appendChild(n)}))}prompt(){return new Promise((t=>{this.setupPromptButtons(t)}))}}var i=function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{c(i.next(t))}catch(t){a(t)}}function s(t){try{c(i.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}c((i=i.apply(t,e||[])).next())}))};let o=!1;function a(t){return null!==t}function r(t){var e,n,i,o;if(null===t)return null;try{const a=JSON.parse(null!==(e=t.research)&&void 0!==e?e:"[]"),r=JSON.parse(null!==(n=t.recipes)&&void 0!==n?n:"[]"),s=JSON.parse(null!==(i=t.inputs)&&void 0!==i?i:"[]"),c=JSON.parse(null!==(o=t.outputs)&&void 0!==o?o:"[]");return[a,r,s,c].forEach((t=>{if(!Array.isArray(t))throw"One of the parameters isn't an array.";t.forEach(((t,e,n)=>{if("number"!=typeof t&&(n[e]=Number(t),isNaN(n[e])))throw"One of the arrays contains something other than a number."}))})),{research:a,recipes:r,inputs:s,outputs:c}}catch(t){return t instanceof SyntaxError?console.error("Malformed JSON, couldn't decode it."):console.error(t),null}}!function(){i(this,void 0,void 0,(function*(){let s=null;window.location.search&&(s=yield function(){return i(this,void 0,void 0,(function*(){if(!a(r(function(){const t=new URLSearchParams(window.location.search);return{research:t.get("research"),recipes:t.get("recipes"),inputs:t.get("inputs"),outputs:t.get("outputs")}}()))){if(yield new n("Invalid Calculation in URL","The calculation specified in the URL after the question mark seems to\n\t\t\tbe invalid. You can continue without it, losing that calculation, or try again.",t.ERROR,[{label:"Continue",retval:!0},{label:"Try again",retval:!1}]).prompt()){const t=new URL(window.location.href);return t.search="",history.pushState(null,"",t.toString()),!1}return new e("Invalid Calculation in URL",'Okay, loading has been aborted. You can edit the URL and try again.<br><br>\n\n\t\t\t\tIf this keeps happening, please do not hesitate to <a href="" target="_blank">create\n\t\t\t\tan issue on GitHub</a>. Provide me the link and I\'ll see what\'s going on.',t.DEFAULT,0,!1),null}return o=!0,!0}))}(),null===s)||o||(s=yield function(){return i(this,void 0,void 0,(function*(){return a(r({research:window.localStorage.getItem("research"),recipes:window.localStorage.getItem("recipes"),inputs:window.localStorage.getItem("inputs"),outputs:window.localStorage.getItem("outputs")}))?(o=!0,!0):(yield new n("Invalid parameters in Local Storage","The data in your browsers local storage seems to be invalid.<br><br>\n\n\t\t\tDo you want to clear it? This will reset all of your selected researches and recipes.",t.ERROR,[{label:"Yes, reset",retval:!0},{label:"No, abort",retval:!1}]).prompt())?(window.localStorage.clear(),window.location.reload(),!1):(new e("Invalid parameters in Local Storage",'Okay, loading has been aborted.<br><br>\n\n\t\t\t\tIf this keeps happening, please do not hesitate to <a href="" target="_blank">create\n\t\t\t\tan issue on GitHub</a>.<br><br>\n\n\t\t\t\tClick <a href="#" onclick="navigator.clipboard.writeText(JSON.stringify(window.localStorage));">\n\t\t\t\there</a> to copy the local storage and provide it when creating an issue.',t.DEFAULT,0,!1),null)}))}())}))}()})();